

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Jobs &mdash; TcEx 0.8.29 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logging" href="logging.html" />
    <link rel="prev" title="Install JSON" href="install_json.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TcEx
          

          
          </a>

          
            
            
              <div class="version">
                0.8.29
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization (Token / HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch.html">Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps.html">Building Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_filter.html">Data Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_tools.html">Development Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="exit.html">Exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_json.html">Install JSON</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Jobs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#groups">Groups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#documents">Documents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#group-to-indicator-associations">Group to Indicator Associations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#group-to-group-associations">Group to Group Associations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#indicators">Indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#indicator-to-indicator-associations">Indicator to Indicator Associations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-occurrence">File Occurrence</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-job-flow">Sample Job Flow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcex_docs/modules.html">tcex</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">Parser / Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbook.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TcEx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Jobs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="jobs">
<span id="id1"></span><h1>Jobs<a class="headerlink" href="#jobs" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This module is being deprecated and will be removed in a future release.  Please use the new Batch module as a replacement.</p>
</div>
<p>The ThreatConnect ™ TcEx Framework provides the <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob" title="tcex.tcex_job.TcExJob"><code class="xref py py-mod docutils literal notranslate"><span class="pre">TcExJob</span></code></a> module to automate writing certain data types to the ThreatConnect API. The App developer can dynamically build a JSON data object and the Job module will handle writing the data to the ThreatConnect API.</p>
<p>Once all the data has been added to the job a call to the <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.process" title="tcex.tcex_job.TcExJob.process"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process()</span></code></a> method will attempt to write the data to the ThreatConnect API.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any failures will set the <a class="reference internal" href="tcex_docs/tcex.tcex.html#tcex.tcex.TcEx.exit_code" title="tcex.tcex.TcEx.exit_code"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exit_code()</span></code></a> to <strong>3</strong> or partial failure, unless the error is defined as a critical failure (defined in the __init__ method of <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob" title="tcex.tcex_job.TcExJob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TcExJob()</span></code></a>.</p>
</div>
<div class="section" id="groups">
<h2>Groups<a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.group" title="tcex.tcex_job.TcExJob.group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">group()</span></code></a> method accepts the following data structure. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Test Description&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
<span class="hll">  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Robin Sparkles&quot;</span><span class="p">,</span>
</span>  <span class="s2">&quot;tag&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;APT&quot;</span>
    <span class="p">},{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;CrimeWare&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
<span class="hll">  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Adversary&quot;</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Jobs module will make multiple API calls to push all this data to the ThreatConnect API.</p>
</div>
<p>The module provides the <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.group_results" title="tcex.tcex_job.TcExJob.group_results"><code class="xref py py-mod docutils literal notranslate"><span class="pre">group_results</span></code></a> property to get the status of each Group submitted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">    <span class="s2">&quot;cached&quot;</span><span class="o">:</span> <span class="p">[],</span>
</span><span class="hll">    <span class="s2">&quot;failed&quot;</span><span class="o">:</span> <span class="p">[],</span>
</span><span class="hll">    <span class="s2">&quot;not_saved&quot;</span><span class="o">:</span> <span class="p">[],</span>
</span><span class="hll">    <span class="s2">&quot;saved&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;Robin Sparkles&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="hll">    <span class="s2">&quot;submitted&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;Robin Sparkles&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>Cached - The Group already existed in ThreatConnect and was pulled from cache.</p></li>
<li><p>Failed - The Group add encountered an error when submitting to the API.</p></li>
<li><p>Not Saved - The Group was not saved either due to a failure or “Halt on Error” was selected and a previous Group failed.</p></li>
<li><p>Saved - The Group was saved to ThreatConnect via the API.</p></li>
<li><p>Submitted - The complete list of submitted Group Names.</p></li>
</ul>
<div class="section" id="documents">
<h3>Documents<a class="headerlink" href="#documents" title="Permalink to this headline">¶</a></h3>
<p>To create a document, use the same structure described above and add <code class="docutils literal notranslate"><span class="pre">fileName</span></code> and <code class="docutils literal notranslate"><span class="pre">fileData</span></code> fields. For example, the following JSON will create a document named <code class="docutils literal notranslate"><span class="pre">test.txt</span></code> with the content <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">is</span> <span class="pre">just</span> <span class="pre">a</span> <span class="pre">test</span></code>:</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Test Description&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
<span class="hll">  <span class="s2">&quot;fileData&quot;</span><span class="o">:</span> <span class="s2">&quot;This is just a test&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;fileName&quot;</span><span class="o">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
</span>  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Test Document&quot;</span><span class="p">,</span>
  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Document&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="group-to-indicator-associations">
<h2>Group to Indicator Associations<a class="headerlink" href="#group-to-indicator-associations" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.group_association" title="tcex.tcex_job.TcExJob.group_association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">group_association()</span></code></a> method accepts the following data structure. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">  <span class="s2">&quot;group_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Robin Sparkles&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;group_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Adversary&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;indicator&quot;</span><span class="o">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;indicator_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Address&quot;</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If more than one Group exist with the same name, the association created using
<a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.group_association" title="tcex.tcex_job.TcExJob.group_association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">group_association()</span></code></a> will only associate the indicator
to the first group found with the name.</p>
</div>
</div>
<div class="section" id="group-to-group-associations">
<h2>Group to Group Associations<a class="headerlink" href="#group-to-group-associations" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.association" title="tcex.tcex_job.TcExJob.association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">association()</span></code></a> method accepts the following data structure to create an association between two groups. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">  <span class="s2">&quot;association_value&quot;</span><span class="o">:</span> <span class="s2">&quot;Incident 1&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;association_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Incident&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;resource_value&quot;</span><span class="o">:</span> <span class="s2">&quot;Pierre Despereaux&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;resource_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Adversary&quot;</span><span class="p">,</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If more than one Group exist with the same name, the association created using
<a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.association" title="tcex.tcex_job.TcExJob.association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">association()</span></code></a> will only associate the indicator
to the first group found with the name.</p>
</div>
</div>
<div class="section" id="indicators">
<h2>Indicators<a class="headerlink" href="#indicators" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.indicator" title="tcex.tcex_job.TcExJob.indicator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">indicator()</span></code></a> method accepts the following data structure. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;associatedGroup&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;8&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Test Description&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;confidence&quot;</span><span class="o">:</span> <span class="mf">5</span><span class="p">,</span>
  <span class="s2">&quot;rating&quot;</span><span class="o">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
<span class="hll">  <span class="s2">&quot;summary&quot;</span><span class="o">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
</span>  <span class="s2">&quot;tag&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;APT&quot;</span>
    <span class="p">},{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;CrimeWare&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
<span class="hll">  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Address&quot;</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To create file indicators using the <code class="docutils literal notranslate"><span class="pre">tcex.tcex_job.indicator()</span></code> function, the <code class="docutils literal notranslate"><span class="pre">summary</span></code> should be a string with each file hash (md5, sha1, and/or sha256) separated by <code class="docutils literal notranslate"><span class="pre">&lt;space&gt;:&lt;space&gt;</span></code>. For example, the following json would create a file indicator with the md5 hash <code class="docutils literal notranslate"><span class="pre">905ad8176a569a36421bf54c04ba7f95</span></code>, sha1 hash <code class="docutils literal notranslate"><span class="pre">a52b6986d68cdfac53aa740566cbeade4452124e</span></code> and sha256 hash <code class="docutils literal notranslate"><span class="pre">25bdabd23e349f5e5ea7890795b06d15d842bde1d43135c361e755f748ca05d0</span></code>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;summary&quot;</span><span class="o">:</span> <span class="s2">&quot;905ad8176a569a36421bf54c04ba7f95 : a52b6986d68cdfac53aa740566cbeade4452124e : 25bdabd23e349f5e5ea7890795b06d15d842bde1d43135c361e755f748ca05d0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;File&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The module provides the <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.indicator_results" title="tcex.tcex_job.TcExJob.indicator_results"><code class="xref py py-mod docutils literal notranslate"><span class="pre">indicator_results</span></code></a> property to get the status of each Indicator submitted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">    <span class="s2">&quot;failed&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;905ad8176a569a36421bf54c04ba7f95 : a52b6986d68cdfac53aa740566cbeade4452124e : 25bdabd23e349f5e5ea7890795b06d15d842bde1d43135c361e755f748ca05d0&quot;</span>
    <span class="p">],</span>
<span class="hll">    <span class="s2">&quot;not_saved&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;905ad8176a569a36421bf54c04ba7f95 : a52b6986d68cdfac53aa740566cbeade4452124e : 25bdabd23e349f5e5ea7890795b06d15d842bde1d43135c361e755f748ca05d0&quot;</span>
    <span class="p">],</span>
<span class="hll">    <span class="s2">&quot;saved&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;1.2.3.4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1.2.3.5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://www.moonmoon.com/whotripme&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HKEY_LOCAL_MACHINE : my-registry-key : REG_DWORD&quot;</span>
    <span class="p">],</span>
<span class="hll">    <span class="s2">&quot;submitted&quot;</span><span class="o">:</span> <span class="p">[</span>
</span>        <span class="s2">&quot;1.2.3.4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1.2.3.5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://www.moonmoon.com/whotripme&quot;</span><span class="p">,</span>
        <span class="s2">&quot;905ad8176a569a36421bf54c04ba7f95 : a52b6986d68cdfac53aa740566cbeade4452124e : 25bdabd23e349f5e5ea7890795b06d15d842bde1d43135c361e755f748ca05d0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HKEY_LOCAL_MACHINE : my-registry-key : REG_DWORD&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>Failed - The Indicator add encountered an error when submitting to the API.</p></li>
<li><p>Not Saved - The Indicator was not saved either due to a failure or “Halt on Error” was selected and a previous Indicator failed.</p></li>
<li><p>Saved - The Indicator was saved to ThreatConnect via the API.</p></li>
<li><p>Submitted - The complete list of submitted Indicator Names.</p></li>
</ul>
</div>
<div class="section" id="indicator-to-indicator-associations">
<h2>Indicator to Indicator Associations<a class="headerlink" href="#indicator-to-indicator-associations" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.association" title="tcex.tcex_job.TcExJob.association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">association()</span></code></a> method accepts the following data structure to create custom, <a class="reference external" href="https://docs.threatconnect.com/en/latest/rest_api/indicators/indicators.html#indicator-to-indicator-associations">Indicator to Indicator Associations</a>. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">  <span class="s2">&quot;association_value&quot;</span><span class="o">:</span> <span class="s2">&quot;ASN1234&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;association_type&quot;</span><span class="o">:</span> <span class="nx">tcex</span><span class="p">.</span><span class="nx">safe_rt</span><span class="p">(</span><span class="s2">&quot;ASN&quot;</span><span class="p">),</span>
</span><span class="hll">  <span class="s2">&quot;resource_value&quot;</span><span class="o">:</span> <span class="s2">&quot;1.2.3.4&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;resource_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Address&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="s2">&quot;custom_association_name&quot;</span><span class="o">:</span> <span class="s2">&quot;ASN to Address&quot;</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The required <code class="docutils literal notranslate"><span class="pre">custom_association_name</span></code> key provides the name of the association you would like to use. These names can be found using the <a class="reference external" href="https://docs.threatconnect.com/en/latest/rest_api/associations/associations.html#retrieving-available-associations">associationTypes</a> API endpoint.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When create an <a class="reference external" href="https://docs.threatconnect.com/en/latest/rest_api/indicators/indicators.html#indicator-to-indicator-associations">Indicator to Indicator</a> association that is a <strong>File Action</strong>, make sure that the ‘parent’ File Indicator is provided as the <code class="docutils literal notranslate"><span class="pre">resource_value</span></code> (<strong>not</strong> the <code class="docutils literal notranslate"><span class="pre">association_value</span></code>).</p>
<p>For example, the following code will properly create an association between a Registry Key and a File Indicator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assoc</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;association_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Registry Key&#39;</span><span class="p">,</span>
  <span class="s1">&#39;association_value&#39;</span><span class="p">:</span> <span class="s1">&#39;HKEY_LOCAL_MACHINE</span><span class="se">\\</span><span class="s1">SYSTEM</span><span class="se">\\</span><span class="s1">CurrentControlSet</span><span class="se">\\</span><span class="s1">Services</span><span class="se">\\</span><span class="s1">6to4 : DeleteFlag : REG_NONE&#39;</span><span class="p">,</span>
  <span class="s1">&#39;custom_association_name&#39;</span><span class="p">:</span> <span class="s1">&#39;File Registry Key&#39;</span><span class="p">,</span>
  <span class="s1">&#39;resource_type&#39;</span><span class="p">:</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span>
  <span class="s1">&#39;resource_value&#39;</span><span class="p">:</span> <span class="s1">&#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#39;</span>
<span class="p">}</span>
<span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">association</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>
</pre></div>
</div>
<p>While the code snippet below will <strong>not</strong> work properly (notice that the location of the ‘parent’ File Indicator and the Registry Key have been switched):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assoc</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;association_type&#39;</span><span class="p">:</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span>
  <span class="s1">&#39;association_value&#39;</span><span class="p">:</span> <span class="s1">&#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#39;</span><span class="p">,</span>
  <span class="s1">&#39;custom_association_name&#39;</span><span class="p">:</span> <span class="s1">&#39;File Registry Key&#39;</span><span class="p">,</span>
  <span class="s1">&#39;resource_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Registry Key&#39;</span><span class="p">,</span>
  <span class="s1">&#39;resource_value&#39;</span><span class="p">:</span> <span class="s1">&#39;HKEY_LOCAL_MACHINE</span><span class="se">\\</span><span class="s1">SYSTEM</span><span class="se">\\</span><span class="s1">CurrentControlSet</span><span class="se">\\</span><span class="s1">Services</span><span class="se">\\</span><span class="s1">6to4 : DeleteFlag : REG_NONE&#39;</span>
<span class="p">}</span>
<span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">association</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="file-occurrence">
<h2>File Occurrence<a class="headerlink" href="#file-occurrence" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.file_occurrence" title="tcex.tcex_job.TcExJob.file_occurrence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">file_occurrence()</span></code></a> method accepts the following data structure. All required fields are highlighted.</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;date&quot;</span> <span class="o">:</span> <span class="s2">&quot;2014-11-03T00:00:00-05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fileName&quot;</span> <span class="o">:</span> <span class="s2">&quot;win999301.dll&quot;</span><span class="p">,</span>
<span class="hll">    <span class="s2">&quot;hash&quot;</span><span class="o">:</span> <span class="s2">&quot;BE7DE2F0CF48294400C714C9E28ECD01&quot;</span><span class="p">,</span>
</span>    <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;C:\\Windows\\System&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The hash value is not part of the File Occurrence body and will be stripped out before
the POST.  It is used to indicate which File Indicator to add the occurrence.</p>
</div>
</div>
<div class="section" id="sample-job-flow">
<h2>Sample Job Flow<a class="headerlink" href="#sample-job-flow" title="Permalink to this headline">¶</a></h2>
<p>The key method calls are highlighted in the following code sample.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tcex</span> <span class="kn">import</span> <span class="n">TcEx</span>
<span class="n">tcex</span> <span class="o">=</span> <span class="n">TcEx</span><span class="p">()</span>

<span class="c1"># Get TcEx parser</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">tcex</span><span class="o">.</span><span class="n">parser</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--owner&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ThreatConnect Owner&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Get parsed args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">tcex</span><span class="o">.</span><span class="n">args</span>

<span class="c1"># add indicator</span>
<span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">indicator</span><span class="p">({</span>
</span>    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;1.2.3.4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Address&#39;</span>
<span class="p">})</span>

<span class="c1"># add group</span>
<span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">group</span><span class="p">({</span>
</span>    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Robin Sparkles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Adversary&#39;</span>
<span class="p">})</span>

<span class="c1"># add associations</span>
<span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">group_association</span><span class="p">({</span>
</span>    <span class="s1">&#39;group_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Robin Sparkles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;group_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Adversary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;indicator&#39;</span><span class="p">:</span> <span class="s1">&#39;1.2.3.4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;indicator_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Address</span>
<span class="p">})</span>

<span class="c1"># process job</span>
<span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>
</span>
<span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">message_tc</span><span class="p">(</span>
</span><span class="hll">    <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> group, </span><span class="si">{}</span><span class="s1"> indicator and </span><span class="si">{}</span><span class="s1"> association added.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span class="hll">    <span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">group_len</span><span class="p">,</span> <span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">indicator_len</span><span class="p">,</span> <span class="n">tcex</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">group_association_len</span><span class="p">))</span>
</span><span class="hll"><span class="n">tcex</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Batch API call allows for Group Associations via the <code class="docutils literal notranslate"><span class="pre">associatedGroup</span></code> field using
the Group Id. However, if Groups are being added in the Job the Group Id will not be known
until after the Group is added.  The <a class="reference internal" href="tcex_docs/tcex.tcex_job.html#tcex.tcex_job.TcExJob.group_association" title="tcex.tcex_job.TcExJob.group_association"><code class="xref py py-meth docutils literal notranslate"><span class="pre">group_association()</span></code></a>
method allows the Group name to be used instead of the Group Id. If the Group Id is
already known it can be associated using the <code class="docutils literal notranslate"><span class="pre">associatedGroup</span></code> field.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="logging.html" class="btn btn-neutral float-right" title="Logging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="install_json.html" class="btn btn-neutral float-left" title="Install JSON" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, ThreatConnect Inc.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>