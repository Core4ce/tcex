

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; TcEx 0.8.26 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="TcEx 0.8.26 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> TcEx
          

          
          </a>

          
            
            
              <div class="version">
                0.8.26
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization (Token / HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch.html">Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps.html">Building Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_filter.html">Data Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_tools.html">Development Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="exit.html">Exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_json.html">Install JSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcex_docs/modules.html">tcex</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">Parser / Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbook.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TcEx</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p id="building-apps-testing">Apps are called from the ThreatConnect Platform using Command Line Interface Arguments or CLI Args.  To simulate being called from ThreatConnect the TcEx <code class="docutils literal"><span class="pre">tcrun</span></code> command provides a method for converting a defined JSON structure to CLI Args.  Running <code class="docutils literal"><span class="pre">tcrun</span></code> will read the <code class="docutils literal"><span class="pre">tcex.json</span></code> file and parse the <strong>args</strong> section from the <strong>default</strong> profile in the <code class="docutils literal"><span class="pre">profiles</span></code> parameter array.  To specify a different file the <code class="docutils literal"><span class="pre">--config</span></code> argument can be passed (e.g. <code class="docutils literal"><span class="pre">--config</span> <span class="pre">my_config.json</span></code>).  To run a specific profile the <code class="docutils literal"><span class="pre">--profile</span></code> argument can be passed (<code class="docutils literal"><span class="pre">--profile</span> <span class="pre">add-indicator</span></code>).  A group of profiles can also be run using the <code class="docutils literal"><span class="pre">--group</span></code> argument (e.g. <code class="docutils literal"><span class="pre">--group</span> <span class="pre">run-all</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When testing a single profile (use case) the <code class="docutils literal"><span class="pre">tcrun</span></code> command would be called using that profile.  Before packaging the App calling <code class="docutils literal"><span class="pre">tcrun</span></code> using a group that will run multiple profiles is typical.</p>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">Â¶</a></h1>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">tcrun</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">autoclear</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">halt_on_fail</span><span class="p">]</span>
             <span class="p">[</span><span class="o">--</span><span class="n">group</span> <span class="n">GROUP</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">logging_level</span> <span class="n">LOGGING_LEVEL</span><span class="p">]</span>
             <span class="p">[</span><span class="o">--</span><span class="n">profile</span> <span class="n">PROFILE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">quiet</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">report</span> <span class="n">REPORT</span><span class="p">]</span>
             <span class="p">[</span><span class="o">--</span><span class="n">truncate</span> <span class="n">TRUNCATE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">unmask</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span>       <span class="n">The</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="s2">&quot;tcex.json&quot;</span><span class="p">)</span>
  <span class="o">--</span><span class="n">autoclear</span>           <span class="n">Clear</span> <span class="n">Redis</span> <span class="n">data</span> <span class="n">before</span> <span class="n">running</span><span class="o">.</span>
  <span class="o">--</span><span class="n">halt_on_fail</span>        <span class="n">Halt</span> <span class="n">on</span> <span class="nb">any</span> <span class="n">failure</span><span class="o">.</span>
  <span class="o">--</span><span class="n">group</span> <span class="n">GROUP</span>         <span class="n">The</span> <span class="n">group</span> <span class="n">of</span> <span class="n">profiles</span> <span class="n">to</span> <span class="n">executed</span><span class="o">.</span>
  <span class="o">--</span><span class="n">logging_level</span> <span class="n">LOGGING_LEVEL</span>
                        <span class="n">The</span> <span class="n">logging</span> <span class="n">level</span><span class="o">.</span>
  <span class="o">--</span><span class="n">profile</span> <span class="n">PROFILE</span>     <span class="n">The</span> <span class="n">profile</span> <span class="n">to</span> <span class="n">be</span> <span class="n">executed</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>
  <span class="o">--</span><span class="n">quiet</span>               <span class="n">Suppress</span> <span class="n">output</span><span class="o">.</span>
  <span class="o">--</span><span class="n">report</span> <span class="n">REPORT</span>       <span class="n">The</span> <span class="n">JSON</span> <span class="n">report</span> <span class="n">filename</span><span class="o">.</span>
  <span class="o">--</span><span class="n">truncate</span> <span class="n">TRUNCATE</span>   <span class="n">The</span> <span class="n">length</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">truncate</span> <span class="n">successful</span> <span class="n">validation</span>
                        <span class="n">data</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">logs</span> <span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">unmask</span>              <span class="n">Unmask</span> <span class="n">masked</span> <span class="n">args</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="profile-format">
<h1>Profile Format<a class="headerlink" href="#profile-format" title="Permalink to this headline">Â¶</a></h1>
<p>Multiple testing profiles can be defined in the <strong>tcex.json</strong> to help testing coverage.  Each profile should include a unique <strong>profile_name</strong> and a group which allows for running multiple profiles at once.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">tcrun</span></code> command provides a feature that allow using environment variables in the <strong>tcex.json</strong> configuration file.  By prefixing the environment variable with <strong>$env.</strong> or <strong>$envs.</strong> the <code class="docutils literal"><span class="pre">tcrun</span></code> command will pull the value from the OS Environment variable. This feature helps facilitate quickly changing values between testing environments and/or user credentials.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">To protect credentials in the <strong>tcex.json</strong> configuration file the <strong>$envs.</strong> feature should be used.  This will keep the credentials out of version control and will mask them on command output.  To unmask the credentials temporarily the <code class="docutils literal"><span class="pre">--unmask</span></code> command can be passed to <code class="docutils literal"><span class="pre">tcrun</span></code>.</p>
</div>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;profiles&quot;</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;api_access_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$env.TC_ACCESS_ID&quot;</span><span class="p">,</span>
      <span class="s2">&quot;api_secret_key&quot;</span><span class="p">:</span> <span class="s2">&quot;$envs.TC_SECRET_KEY&quot;</span><span class="p">,</span>
      <span class="s2">&quot;logging&quot;</span><span class="p">:</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_api_path&quot;</span><span class="p">:</span> <span class="s2">&quot;$env.TC_API_PATH&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_log_path&quot;</span><span class="p">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_log_to_api&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;tc_out_path&quot;</span><span class="p">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_playbook_db_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Redis&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_playbook_db_context&quot;</span><span class="p">:</span> <span class="s2">&quot;7960ab08-26cb-4140-abb9-9310bb45ac86&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_playbook_db_path&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_playbook_db_port&quot;</span><span class="p">:</span> <span class="s2">&quot;6379&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_proxy_host&quot;</span><span class="p">:</span> <span class="s2">&quot;10.10.10.10&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_proxy_port&quot;</span><span class="p">:</span> <span class="s2">&quot;3128&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tc_proxy_external&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;tc_proxy_tc&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;tc_temp_path&quot;</span><span class="p">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
      <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;#App:1234:slack-string!String&quot;</span><span class="p">,</span>
      <span class="s2">&quot;slack_api_token&quot;</span><span class="p">:</span> <span class="s2">&quot;$envs.SLACK_API_TOKEN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;slack_recipient&quot;</span><span class="p">:</span> <span class="s2">&quot;@bob&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;run-all&quot;</span><span class="p">],</span>
    <span class="s2">&quot;install_json&quot;</span><span class="p">:</span> <span class="s2">&quot;install.json&quot;</span><span class="p">,</span>
    <span class="s2">&quot;quiet&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;profile_name&quot;</span><span class="p">:</span> <span class="s2">&quot;send-slack-message&quot;</span>
  <span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>args</strong> section should contain all the CLI Args your app requires to run. The <strong>groups</strong> section defines which groups this profile should run under and the <strong>profile_name</strong> is the name which can be used to run the profile.  The <strong>quiet</strong> field indicates whether the app should print output.</p>
</div>
</div>
<div class="section" id="profile-creation">
<h1>Profile Creation<a class="headerlink" href="#profile-creation" title="Permalink to this headline">Â¶</a></h1>
<p>The TcEx framework provides the <code class="docutils literal"><span class="pre">tcprofile</span></code> command to automatically generate a profile from the install.json file.  The output of the <code class="docutils literal"><span class="pre">tcprofile</span></code> command will set the exit_code to 0 by default, however testing failure scenarios is also possible by setting the exit code to 1. Some default values will be added to the args section, but any custom inputs will need to be populated with the appropriate data.</p>
<p>For playbook Apps the <code class="docutils literal"><span class="pre">tcprofile</span></code> command will also create 2 standard validations for each output variable.  The first validation will check to see if the output variable is <strong>null</strong> and the second will ensure the output variables is the correct type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">tcprofile</span></code> command can be run multiple times to generate several different profiles with different input and/or output variables.</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>usage: tcprofile <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--action <span class="o">{</span>create,delete,replace_validation,update<span class="o">}]</span>
                 <span class="o">[</span>--ij IJ<span class="o">]</span> <span class="o">[</span>--data_file<span class="o">]</span> <span class="o">[</span>--outdir OUTDIR<span class="o">]</span> <span class="o">[</span>--outfile OUTFILE<span class="o">]</span>
                 --profile_name PROFILE_NAME <span class="o">[</span>--redis_hash REDIS_HASH<span class="o">]</span>
                 <span class="o">[</span>--redis_host REDIS_HOST<span class="o">]</span> <span class="o">[</span>--redis_port REDIS_PORT<span class="o">]</span>

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  --action <span class="o">{</span>create,delete,replace_validation,update<span class="o">}</span>
  --ij IJ               The install.json file name <span class="o">(</span>default: install.json<span class="o">)</span>.
  --data_file           Attempt to build data file templates <span class="k">for</span> the profile.
  --outdir OUTDIR       The *base* output directory containing the
                        data/profiles folder.
  --outfile OUTFILE     The name of the file to write the profile.
  --profile_name PROFILE_NAME
                        The profile name to create, delete, or update.
  --redis_hash REDIS_HASH
                        The redis hash.
  --redis_host REDIS_HOST
                        The redis host.
  --redis_port REDIS_PORT
                        The redis port.
</pre></div>
</div>
</div>
<div class="section" id="staging-redis-data">
<h1>Staging Redis Data<a class="headerlink" href="#staging-redis-data" title="Permalink to this headline">Â¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">A local instance of Redis must be running to test Playbook Apps locally.</p>
</div>
<p>In order to test using variable inputs the data can be manually added to Redis.  The <code class="docutils literal"><span class="pre">tcrun</span></code> command has functionality to âstageâ the data in redis that can be used to simulate an upstream App writing data to Redis.  This staged data can be and added to a single json file or multiple reusable files.  Once the files have been created they should be referenced in the Profile.</p>
</div>
<div class="section" id="example-data-file">
<h1>Example Data File<a class="headerlink" href="#example-data-file" title="Permalink to this headline">Â¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Data files can contain a single data input or multiple data inputs.  In most cases it better to have separate files so the data can be reused in multiple Profiles.</p>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">[{</span>
  <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="p">[{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">125</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;threat001-build-testing&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Threat&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ownerName&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateAdded&quot;</span><span class="o">:</span> <span class="s2">&quot;2017-08-16T18:45:42-04:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mytc.myorg.com/auth/threat/threat.xhtml?threat=125&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">124</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;incident001-build-testing&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Incident&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ownerName&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateAdded&quot;</span><span class="o">:</span> <span class="s2">&quot;2017-08-16T18:44:57-04:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mytc.myorg.com/auth/incident/incident.xhtml?incident=124&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">123</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;doc001-build-testing&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ownerName&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateAdded&quot;</span><span class="o">:</span> <span class="s2">&quot;2017-08-16T18:43:54-04:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mytc.myorg.com/auth/document/document.xhtml?document=123&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">122</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;camp001-build-testing&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Campaign&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ownerName&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateAdded&quot;</span><span class="o">:</span> <span class="s2">&quot;2017-08-16T18:40:56-04:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mytc.myorg.com/auth/campaign/campaign.xhtml?campaign=122&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">116</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;adver001-build-testing&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Adversary&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ownerName&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateAdded&quot;</span><span class="o">:</span> <span class="s2">&quot;2017-08-16T18:35:07-04:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://mytc.myorg.com/auth/adversary/adversary.xhtml?adversary=116&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;variable&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:0022:groups!TCEntityArray&quot;</span>
<span class="p">}]</span>
</pre></div>
</div>
</div>
<div class="section" id="profile-with-data-file">
<h1>Profile with Data File<a class="headerlink" href="#profile-with-data-file" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">[{</span>
  <span class="s2">&quot;args&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;api_access_id&quot;</span><span class="o">:</span> <span class="s2">&quot;$env.API_ACCESS_ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;api_secret_key&quot;</span><span class="o">:</span> <span class="s2">&quot;$envs.API_SECRET_KEY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;logging&quot;</span><span class="o">:</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_api_path&quot;</span><span class="o">:</span> <span class="s2">&quot;$env.TC_API_PATH&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_log_path&quot;</span><span class="o">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_log_to_api&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;tc_out_path&quot;</span><span class="o">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_temp_path&quot;</span><span class="o">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_playbook_db_type&quot;</span><span class="o">:</span> <span class="s2">&quot;Redis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_playbook_db_context&quot;</span><span class="o">:</span> <span class="s2">&quot;1860ab08-26cb-4140-abb9-9310bb45ac86&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_playbook_db_path&quot;</span><span class="o">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_playbook_db_port&quot;</span><span class="o">:</span> <span class="s2">&quot;6379&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tc_playbook_out_variables&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:0072:tc.tag.fail_count!String,#App:0072:tc.tag.success_count!String,#App:0072:tc.tag.tags!StringArray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:0022:groups!TCEntityArray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tag&quot;</span><span class="o">:</span> <span class="s2">&quot;QaTagCreate&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;data_files&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;tcex.d/data/groups.json&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;Pass test of create tag.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="s2">&quot;qa-build&quot;</span><span class="p">,</span>
  <span class="s2">&quot;profile_name&quot;</span><span class="o">:</span> <span class="s2">&quot;create-tag-on-groups&quot;</span><span class="p">,</span>
  <span class="s2">&quot;quiet&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="s2">&quot;script&quot;</span><span class="o">:</span> <span class="s2">&quot;tc_tag&quot;</span><span class="p">,</span>
<span class="p">}]</span>
</pre></div>
</div>
</div>
<div class="section" id="data-validation">
<h1>Data Validation<a class="headerlink" href="#data-validation" title="Permalink to this headline">Â¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">tcrun</span></code> command provides some basic data validation for output variables.  By defining the <strong>validations</strong> parameter array in the <strong>tcex.json</strong> file the <code class="docutils literal"><span class="pre">tcrun</span></code> command will pull the values from the REDIS DB and perform the provided operator on the data. This action simulates a downstream App reading the data from REDIS.</p>
<p><strong>Example Configuration</strong></p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="s2">&quot;validations&quot;</span><span class="o">:</span> <span class="p">[{</span>
    <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">&quot;operator&quot;</span><span class="o">:</span> <span class="s2">&quot;ne&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:1073:tc.association.success_count!String&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="s2">&quot;operator&quot;</span><span class="o">:</span> <span class="s2">&quot;it&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:1073:tc.association.success_count!String&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">&quot;operator&quot;</span><span class="o">:</span> <span class="s2">&quot;ne&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:1073:tc.association.fail_count!String&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="s2">&quot;operator&quot;</span><span class="o">:</span> <span class="s2">&quot;it&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="o">:</span> <span class="s2">&quot;#App:1073:tc.association.fail_count!String&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p><strong>Supported Operators</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;eq&#39;</span> <span class="c1"># equal to</span>
<span class="s1">&#39;ew&#39;</span> <span class="c1"># ends with</span>
<span class="s1">&#39;ge&#39;</span> <span class="c1"># greater than or equal to</span>
<span class="s1">&#39;gt&#39;</span> <span class="c1"># greater than</span>
<span class="s1">&#39;in&#39;</span> <span class="c1"># in array</span>
<span class="s1">&#39;ni&#39;</span> <span class="c1"># not in array</span>
<span class="s1">&#39;it&#39;</span> <span class="c1"># is type (array, binary, entity, string)</span>
<span class="s1">&#39;lt&#39;</span> <span class="c1"># less than</span>
<span class="s1">&#39;le&#39;</span> <span class="c1"># less than or equal to</span>
<span class="s1">&#39;ne&#39;</span> <span class="c1"># not equal</span>
<span class="s1">&#39;sw&#39;</span> <span class="c1"># start with</span>
</pre></div>
</div>
</div>
<div class="section" id="exit-codes">
<h1>Exit Codes<a class="headerlink" href="#exit-codes" title="Permalink to this headline">Â¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">tcrun</span></code> command can validate the exit code of the App.  This allows for setting up fail scenarios profiles.  All Apps should exit with a valid exit code and handle failures gracefully.  Using the exit_codes parameter you can provide âbadâ data to the App and ensure it exits with the proper exit code.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="s2">&quot;exit_codes&quot;</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For Runtime/Job Apps (non Playbook Apps) valid exit codes are 0, 1, and 3.  For certain profiles you may expect an exit code of 0 for success or 3 for partial success/partial failure.  This can be achieved by adding both status codes to the <strong>exit_codes</strong> parameter array.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, ThreatConnect Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.8.26',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>